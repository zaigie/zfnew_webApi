
åŸºäºDjangoçš„æ–°æ­£æ–¹æ•™åŠ¡ç®¡ç†ç³»ç»Ÿçš„çˆ¬è™«webApiï¼Œè¯·æ±‚**è¿”å›JSONæ•°æ®**

éƒ¨åˆ†æœ¬åœ°APIåŸºäº[NeroAsmarr/zfnew](https://github.com/NeroAsmarr/zfnew)ã€2020.2.16ã€‘

ç›®å‰é¡¹ç›®éƒ¨ç½²åœ¨â€œè¥¿é™¢åŠ©æ‰‹â€å¾®ä¿¡å°ç¨‹åºä¸­ä½œä¸ºAPIæµ‹è¯•ï¼ˆä¸´æ—¶ï¼Œåå°†é‡æ„ä¸ºäº‘å¼€å‘nodejsçˆ¬è™«ï¼‰

æ±‚â­â­â­â­â­ï¼ˆè·ª

## ä½¿ç”¨æ–¹æ³•

### JSONæ•°æ®é”®å€¼å‚ç…§

 - ç‚¹å‡»[JSONé”®å€¼](#JSONé”®å€¼)è®¿é—®è¿”å›çš„JSONæ•°æ®é”®å€¼åç§°å‚ç…§

### Tips

 - é€šè¿‡pinfoæ–°å¢å­¦ç”Ÿï¼Œå¹¶å°†cookieså­˜å…¥æ•°æ®åº“
 - è¯·æ±‚å…¶å®ƒå†…å®¹æ—¶ï¼Œcookieså¤±æ•ˆåå°†é‡æ–°æ‰§è¡Œç™»å½•ï¼Œå¹¶æ›´æ–°æ•°æ®åº“ä¸­çš„ä¸¤ä¸ªcookieså­—æ®µå’ŒupdateTimeå­—æ®µä»¥åŠå¢åŠ refreshTimesæ¬¡æ•°å­—æ®µï¼ˆè¯·æ±‚å†…å®¹å¤±è´¥å¯èƒ½å¹¶ä¸å®Œå…¨æ˜¯å› ä¸ºcookieså¤±æ•ˆï¼Œä½†ç›®å‰æš‚æœªé‡åˆ°å…¶å®ƒé”™è¯¯ï¼Œä¸”æ›´æ–°cookiesä¹Ÿæ˜¯ä¸€ä¸ªè¾ƒä¸ºé€šç”¨çš„è§£å†³åŠæ³•ï¼‰
 - config.jsonä¸­çš„proxyä¸º**httpä»£ç†**
 - é€‰è¯¾APIå¯èƒ½**å¹¶ä¸é€šç”¨**ï¼Œè¿™é‡Œä»…æä¾›æ€è·¯ï¼Œå…·ä½“è¯·å‚ç…§è‡ªå·±å­¦æ ¡æƒ…å†µ
 - ä»£ç ä¸­æœ‰å…³äºå¼€å‘è€…æœ¬æ ¡çš„**å½•å–æŸ¥è¯¢(recruitApp)**ï¼Œ**ä¸é€šç”¨**ï¼Œè¯·è‡ªè¡Œç¼–å†™æ›¿æ¢æˆ–åˆ é™¤
 - é‰´äºå®ç°æ–¹å¼å’Œå¹¶å‘é‡ï¼Œå¹¶**ä¸æ¨è**å°†æœ¬é¡¹ç›®éƒ¨ç½²åˆ°äº§å“é¡¹ç›®ä¸­
 - CentOsè‡ªå¸¦çš„sqlite3ç‰ˆæœ¬è¾ƒä½ï¼Œ**Django2.1.8**ä»¥ä¸Šä¸å…¼å®¹
     - è§£å†³åŠæ³•ä¸€ï¼šé€šè¿‡requirements.txtå®‰è£…æ¨¡å—ï¼Œå°†requirements.txtä¸­çš„Djangoç‰ˆæœ¬**æ›´æ”¹ä¸º2.1.8**
     - è§£å†³åŠæ³•äºŒï¼šå‡çº§è‡ªå¸¦çš„sqlite3ç‰ˆæœ¬ï¼Œå¹¶é‡æ–°é“¾æ¥ï¼ˆç§»æ­¥ç™¾åº¦
 - **éƒ¨ç½²çš„æ—¶å€™ä»£ç ä¸­Serveré…±éƒ¨åˆ†éº»çƒ¦æ¢æˆè‡ªå·±çš„**ğŸ™

### POSTåœ°å€&Data
#### è¯·æ±‚ä¿¡æ¯
```
ä¸ªäººä¿¡æ¯(å¿…é¡»ï¼Œç”¨ä»¥ç™»å½•)ï¼šxxx:8000/info/pinfo
â€»ä¿¡æ¯FromData={xh:'å­¦å·',pswd:'å¯†ç '}

åœè¡¥æ¢è¯¾æ¶ˆæ¯ï¼šxxx:8000/info/message
â€»æ¶ˆæ¯FromData={xh:'å­¦å·',pswd:'å¯†ç '}

è¯¾ç¨‹ä¿®è¯»æƒ…å†µ(å­¦ä¸šè¯¦æƒ…)ï¼šxxx:8000/info/study
â€»å­¦ä¸šFromData={xh:'å­¦å·',pswd:'å¯†ç '}

è¯·æ±‚æˆç»©: xxx:8000/info/grade
â€»æˆç»©FromData={xh:'å­¦å·',pswd:'å¯†ç ',year:'æŸ¥è¯¢å­¦å¹´',term:'æŸ¥è¯¢å­¦æœŸ'}

è¯·æ±‚è¯¾è¡¨ï¼šxxx:8000/info/schedule
â€»è¯¾è¡¨FromData={xh:'å­¦å·',pswd:'å¯†ç ',year:'æŸ¥è¯¢å­¦å¹´',term:'æŸ¥è¯¢å­¦æœŸ'}

æ‰‹åŠ¨æ›´æ–°cookiesï¼šxxx:8000/info/update
â€»æ›´æ–°FromData={xh:'å­¦å·',pswd:'å¯†ç '}
```
#### é€‰è¯¾è¯·æ±‚
```
è¯·æ±‚å·²é€‰è¯¾ç¨‹ï¼šxxx:8000/choose/choosed
â€»å·²é€‰FromData={xh:'å­¦å·',pswd:'å¯†ç '}

æ¿å—è¯¾ï¼šxxx:8000/choose/bkk
æ¿å—è¯¾FromData={xh:'å­¦å·',pswd:'å¯†ç ',bkk:'1 or 2'}

(Todo)é€‰æ‹©æŸè¯¾ï¼šxxx:8000/choose/confirm
â€»é€‰è¯¾FromData={xh:'å­¦å·',pswd:'å¯†ç ',id:'æ•™å­¦ç­ID'}

(Todo)é€€æ‰æŸè¯¾ï¼šxxx:8000/choose/cancel
â€»é€€è¯¾FromData={xh:'å­¦å·',pswd:'å¯†ç ',id:'æ•™å­¦ç­ID'}
```

### é¢å¤–è¯·æ±‚
```
oneÂ·ä¸€ä¸ª æ¯æ—¥æ–‡å­—ï¼šxxx:8000/one
â€»GETè¯·æ±‚

å½•å–æŸ¥è¯¢ï¼ˆé€šè¿‡å¼€å‘è€…æ‰€åœ¨å­¦æ ¡æ‹›ç”Ÿç½‘è·å–æ•°æ®ï¼Œä¸é€šç”¨ï¼‰ï¼šxxx:8000/recruit/ksh(idcard)
â€»å½•å–FromData={ksh:'è€ƒç”Ÿå·'(idcard:'èº«ä»½è¯å·')}
```

## ä½¿ç”¨éƒ¨ç½²
 - æ¨èä½¿ç”¨**uswgi+nginx**ï¼Œå…·ä½“éƒ¨ç½²å¯ç§»æ­¥ç™¾åº¦
 - æ›´æ”¹config.jsonä¸­å„é¡¹ï¼šbase_urlä¸ºå­¦æ ¡æ•™åŠ¡ç³»ç»Ÿç½‘å€ï¼Œproxyä¸ºhttpä»£ç†

## æµ‹è¯•éƒ¨ç½²(å»ºè®®ä»…æµ‹è¯•ç”¨)

 - è¯·ç¡®ä¿æœåŠ¡å™¨æˆ–è™šæ‹Ÿç¯å¢ƒå®‰è£…äº†**Python3.6**åŠä»¥ä¸Šç‰ˆæœ¬

### 1.å®‰è£…ä¾èµ–æ¨¡å—

```shell
$ pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt
```

### 2.å¼€æ”¾å®‰å…¨ç»„é…ç½®
 - å¼€æ”¾80ã€8000ç«¯å£

### 3.ç”¨ç»ˆç«¯æ‰“å¼€zfnwebæ–‡ä»¶å¤¹ï¼Œå¹¶è¿è¡Œ

```shell
$ python manage.py runserver 0.0.0.0:8000
```

è®¿é—®ä½ æœåŠ¡å™¨çš„**IPåœ°å€:8000**

# JSONé”®å€¼

## ä¸ªäººä¿¡æ¯ï¼ˆç™»å½•ï¼‰

```json
{
    "name": "å­¦ç”Ÿå§“å",
    "studentId": "å­¦ç”Ÿå­¦å·",
    "birthDay": "å‡ºç”Ÿæ—¥æœŸ",
    "idNumber": "èº«ä»½è¯å·ç ",
    "candidateNumber": "è€ƒç”Ÿå·",
    "status": "åœ¨è¯»æƒ…å†µ",
    "collegeName": "æ‰€åœ¨é™¢ç³»",
    "majorName": "æ‰€åœ¨ä¸“ä¸š",
    "className": "æ‰€åœ¨ç­çº§",
    "entryDate": "å…¥å­¦æ—¶é—´",
    "graduationSchool": "æ¯•ä¸šé«˜ä¸­",
    "domicile": "ç±è´¯",
    "phoneNumber": "ç”µè¯å·ç ",
    "parentsNumber": "å®¶é•¿å·ç ",
    "email": "ç”µå­é‚®ç®±",
    "politicalStatus": "æ”¿æ²»é¢è²Œ",
    "national": "æ°‘æ—",
    "education": "å­¦å†",
    "postalCode": "é‚®ç¼–",
    "grade": "å¹´çº§"
}
```

## å­¦ä¸šæƒ…å†µ

```json
{
    "gpa":"å¹³å‡å­¦åˆ†ç»©ç‚¹GPA",
    "ipa":"è®¡åˆ’å†…æ€»è¯¾ç¨‹æ•°",
    "ipp":"è®¡åˆ’å†…å·²è¿‡è¯¾ç¨‹æ•°",
    "ipf":"è®¡åˆ’å†…æœªè¿‡è¯¾ç¨‹æ•°",
    "ipn":"è®¡åˆ’å†…æœªä¿®è¯¾ç¨‹æ•°",
    "ipi":"è®¡åˆ’å†…åœ¨è¯»è¯¾ç¨‹æ•°",
    "opp":"è®¡åˆ’å¤–å·²è¿‡è¯¾ç¨‹æ•°",
    "opf":"è®¡åˆ’å¤–æœªè¿‡è¯¾ç¨‹æ•°",
    "tsData":{
        "tsPoint":{
            "tsr":"é€šè¯†æ•™è‚²è¦æ±‚å­¦åˆ†",
            "tsg":"é€šè¯†æ•™è‚²å·²å¾—å­¦åˆ†",
            "tsn":"é€šè¯†æ•™è‚²æœªå¾—å­¦åˆ†",
        },
        "tsItems":[{
            "courseTitle":"è¯¾ç¨‹åç¨‹",
            "courseId":"è¯¾ç¨‹å·",
            "courseSituation":"ä¿®è¯»çŠ¶æ€",
            "courseTerm":"ä¿®è¯»å­¦æœŸ",
            "courseCategory": "è¯¾ç¨‹ç±»åˆ«",
            "courseAttribution": "è¯¾ç¨‹æ€§è´¨",
            "maxGrade":"æœ€é«˜æˆç»©",
            "credit":"è¯¾ç¨‹å­¦åˆ†",
            "gradePoint":"è¯¾ç¨‹ç»©ç‚¹",
        }],
        },
    "tzdata":{
        "tzPoint":{
            "tzr":"æ‹“å±•æ•™è‚²è¦æ±‚å­¦åˆ†",
            "tzg":"æ‹“å±•æ•™è‚²å·²å¾—å­¦åˆ†",
            "tzn":"æ‹“å±•æ•™è‚²æœªå¾—å­¦åˆ†",
        },
        "tzItems":[{
            "courseTitle":"è¯¾ç¨‹åç¨‹",
            "courseId":"è¯¾ç¨‹å·",
            "courseSituation":"ä¿®è¯»çŠ¶æ€",
            "courseTerm":"ä¿®è¯»å­¦æœŸ",
            "courseCategory": "è¯¾ç¨‹ç±»åˆ«",
            "courseAttribution": "è¯¾ç¨‹æ€§è´¨",
            "maxGrade":"æœ€é«˜æˆç»©",
            "credit":"è¯¾ç¨‹å­¦åˆ†",
            "gradePoint":"è¯¾ç¨‹ç»©ç‚¹",
        }],
        },
    "zydata":{
        "zyPoint":{
            "zyr":"ä¸“ä¸šæ•™è‚²è¦æ±‚å­¦åˆ†",
            "zyg":"ä¸“ä¸šæ•™è‚²å·²å¾—å­¦åˆ†",
            "zyn":"ä¸“ä¸šæ•™è‚²æœªå¾—å­¦åˆ†",
        },
        "zyItems":[{
            "courseTitle":"è¯¾ç¨‹åç¨‹",
            "courseId":"è¯¾ç¨‹å·",
            "courseSituation":"ä¿®è¯»çŠ¶æ€",
            "courseTerm":"ä¿®è¯»å­¦æœŸ",
            "courseCategory": "è¯¾ç¨‹ç±»åˆ«",
            "courseAttribution": "è¯¾ç¨‹æ€§è´¨",
            "maxGrade":"æœ€é«˜æˆç»©",
            "credit":"è¯¾ç¨‹å­¦åˆ†",
            "gradePoint":"è¯¾ç¨‹ç»©ç‚¹",
        }],
        },
    "qtdata":{
        "qtPoint":"{å…¶å®ƒè¯¾ç¨‹ä¸€èˆ¬æ— å­¦åˆ†è¦æ±‚}",
        "qtItems":[{
            "courseTitle":"è¯¾ç¨‹åç¨‹",
            "courseId":"è¯¾ç¨‹å·",
            "courseSituation":"ä¿®è¯»çŠ¶æ€",
            "courseTerm":"ä¿®è¯»å­¦æœŸ",
            "courseCategory": "è¯¾ç¨‹ç±»åˆ«",
            "courseAttribution": "è¯¾ç¨‹æ€§è´¨",
            "maxGrade":"æœ€é«˜æˆç»©",
            "credit":"è¯¾ç¨‹å­¦åˆ†",
            "gradePoint":"è¯¾ç¨‹ç»©ç‚¹",
        }],
        },
}
```

## åœè¡¥è¯¾æ¶ˆæ¯

```json
[
    {
        "message": "æ¶ˆæ¯å†…å®¹", 
        "ctime": "æ¶ˆæ¯åˆ›å»ºæ—¶é—´"
    }
]
```

## æˆç»©ä¿¡æ¯

```json
{
    "name": "å­¦ç”Ÿå§“å",
    "studentId": "å­¦ç”Ÿå­¦å·",
    "schoolYear": "æŸ¥è¯¢å­¦å¹´",
    "schoolTerm": "æŸ¥è¯¢å­¦æœŸ",
    "course": [{
        "courseTitle": "è¯¾ç¨‹åç¨‹",
        "teacher": "è¯¾ç¨‹è€å¸ˆ",
        "courseId": "è¯¾ç¨‹å·",
        "className": "æ•™å­¦ç­åç§°",
        "courseNature": "è¯¾ç¨‹æ€§è´¨",
        "credit": "è¯¾ç¨‹å­¦åˆ†",
        "grade": "è¯¾ç¨‹æˆç»©",
        "gradePoint": "è¯¾ç¨‹ç»©ç‚¹",
        "gradeNature": "è€ƒè¯•æ€§è´¨",
        "startCollege": "æˆè¯¾é™¢ç³»",
        "courseMark": "ä¸»/é€‰ä¿®",
        "courseCategory": "è¯¾ç¨‹ç±»åˆ«",
        "courseAttribution": "è¯¾ç¨‹æ–¹å‘"
    }]
}
```

## è¯¾è¡¨ä¿¡æ¯
```json
{
    "name": "å­¦ç”Ÿå§“å",
    "studentId": "å­¦ç”Ÿå­¦å·",
    "schoolYear": "æŸ¥è¯¢å­¦å¹´",
    "schoolTerm": "æŸ¥è¯¢å­¦æœŸ",
    "normalCourse": [{
        "courseTitle": "è¯¾ç¨‹åç¨‹",
        "courseTitleShort":"è¯¾ç¨‹çŸ­åç§°(è¶…è¿‡xä¸ªå­—ç¬¦æ˜¾ç¤ºçœç•¥å·)",
        "teacher": "è¯¾ç¨‹è€å¸ˆ",
        "courseId": "è¯¾ç¨‹å·",
        "courseWeekday":"æ˜ŸæœŸå‡ ",
        "courseSection": "è¯¾ç¨‹èŠ‚æ•°",
        "courseWeek": "è¯¾ç¨‹å‘¨æ•°",
        "exam":"è€ƒè¯•æ€§è´¨",
        "campus": "ä¸Šè¯¾æ ¡åŒº",
        "courseRoom": "ä¸Šè¯¾åœ°ç‚¹",
        "className": "æ•™å­¦ç­åç§°",
        "hoursComposition": "å­¦æ—¶",
        "weeklyHours": "å‘¨å­¦æ—¶",
        "totalHours": "æ€»å­¦æ—¶",
        "credit": "è¯¾ç¨‹å­¦åˆ†"
    }],
}
```

## å·²é€‰è¯¾ç¨‹

```json
{
    "courseNumber":"å·²é€‰è¯¾ç¨‹æ•°",
    "items":[{
        "courseTitle":"è¯¾ç¨‹åç¨‹",
        "courseCategory":"è¯¾ç¨‹ç±»åˆ«",
        "teacher":"è¯¾ç¨‹è€å¸ˆ",
        "teacher_id":"è€å¸ˆID",
        "classId":"æ•™å­¦ç­ID",
        "classVolume":"æ•™å­¦ç­å®¹é‡",
        "classPeople":"æ•™å­¦ç­å·²é€‰äººæ•°",
        "courseRoom":"ä¸Šè¯¾åœ°ç‚¹",
        "courseId":"è¯¾ç¨‹å·",
        "courseTime":"ä¸Šè¯¾æ—¶é—´",
        "credit":"è¯¾ç¨‹å­¦åˆ†",
        "chooseSelf":"æ˜¯å¦è‡ªé€‰",
        "waiting":"æ˜¯å¦å¾…ç­›é€‰"
        }]
}
```

## æ¿å—è¯¾åˆ—è¡¨

```json
{
    "courseNumber":"æ•™å­¦ç­æ•°é‡",
    "items":[{
        "courseTitle":"è¯¾ç¨‹åç¨‹",
        "teacher":"è¯¾ç¨‹è€å¸ˆ",
        "teacher_id":"è€å¸ˆID",
        "classId":"æ•™å­¦ç­ID",
        "doId":"æ‰§è¡ŒID",
        "classVolume":"æ•™å­¦ç­å®¹é‡",
        "classPeople":"æ•™å­¦ç­å·²é€‰äººæ•°",
        "courseRoom":"ä¸Šè¯¾åœ°ç‚¹",
        "courseId":"è¯¾ç¨‹å·",
        "courseTime":"ä¸Šè¯¾æ—¶é—´",
        "credit":"è¯¾ç¨‹å­¦åˆ†"
        }]
}
```